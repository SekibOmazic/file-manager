events {
    worker_connections 1024;
}

http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    server {
        listen 80;
        server_name localhost;

        # Health check endpoint
        location /download/health {
            return 200 'OK';
            add_header Content-Type text/plain;
        }

        # File downloads with ID mapping
        location ~ ^/download/(\d+)$ {
            set $file_id $1;

            # Map file IDs to actual files
            if ($file_id = "1") {
                set $file_name "Test_Data_1MB_PDF.pdf";
            }
            if ($file_id = "2") {
                set $file_name "Test_Data_500KB_PDF.pdf";
            }

            # Default if no mapping found
            if ($file_name = "") {
                return 404 "File not found";
            }

            alias /usr/share/nginx/html/files/$file_name;

            # Set appropriate headers for file download
            add_header Content-Disposition "attachment; filename=$file_name";
            add_header Content-Type application/pdf;
        }

        # Fallback for any other requests
        location / {
            return 404 "Not found";
        }
    }
}